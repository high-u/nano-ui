<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Test - nanoui.js</title>
    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
        max-width: 600px;
        margin: 40px auto;
        padding: 20px;
      }
      .counter {
        font-size: 24px;
        margin-bottom: 20px;
      }
      button {
        padding: 8px 16px;
        margin: 5px;
        font-size: 14px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background-color: #4CAF50;
        color: white;
      }
      button:hover {
        background-color: #45a049;
      }
      .task-list {
        margin-top: 20px;
      }
      .task-item {
        padding: 8px;
        margin: 4px 0;
        background-color: #f5f5f5;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
  </body>
  <script type="module">
    import { h, render } from '../src/nanoui.js';

    // カウンターのテスト（単一要素）
    let count = 0;
    const counterContainer = h('div', { class: 'counter' });
    const incrementButton = h('button', { onClick: () => {
      count++;
      renderCounter();
    }}, '+1');
    const decrementButton = h('button', { onClick: () => {
      count--;
      renderCounter();
    }}, '-1');

    const renderCounter = render({
      container: counterContainer,
      createElement: () => h('span', {}, `Count: ${count}`)
    });

    // タスクリストのテスト（配列）
    let tasks = [
      { id: 1, name: 'タスク1', completed: false },
      { id: 2, name: 'タスク2', completed: true }
    ];
    let taskId = 3;

    function createTaskElement(task) {
      return h('div', { class: 'task-item' },
        h('span', {}, `${task.name} ${task.completed ? '(完了)' : ''}`)
      );
    }

    const taskListContainer = h('div');
    const addTaskButton = h('button', { onClick: () => {
      tasks.push({
        id: taskId++,
        name: `タスク${taskId - 1}`,
        completed: false
      });
      renderTasks(tasks);
    }}, 'タスク追加');

    const renderTasks = render({
      container: taskListContainer,
      keySelector: task => task.id,
      createElement: createTaskElement
    });

    // 全体を構築
    document.body.append(
      h('h1', {}, 'Test - nanoui.js'),
      counterContainer,
      incrementButton,
      decrementButton,
      h('div', { class: 'task-list' },
        h('h2', {}, 'タスクリスト'),
        taskListContainer,
        addTaskButton
      )
    );

    // 初期表示
    renderCounter();
    renderTasks(tasks);
  </script>
</html>
